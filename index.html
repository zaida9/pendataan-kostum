<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sistem Pendataan Kostum</title>

  <style>
    body { margin:0; font-family: Arial, sans-serif; background:#f4f7fb; }

    #loginPage { display:flex; height:100vh; align-items:center; justify-content:center; }

    .login-box { background:white; padding:40px; border-radius:12px; box-shadow:0 4px 20px rgba(0,0,0,.1); width:300px; text-align:center; }
    .login-box h2 { margin-bottom:20px; color:#64b5f6; }
    .login-box input { width:100%; padding:10px; margin-bottom:10px; border:1px solid #ddd; border-radius:8px; }
    .login-box button { width:100%; padding:10px; background:#64b5f6; color:white; border:none; border-radius:8px; cursor:pointer; }
    .error { color:red; font-size:12px; margin-bottom:10px; }

    #mainApp { display:none; padding:20px; }

    .topbar { background:white; padding:15px 20px; border-radius:10px; display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }

    .btn-logout { background:#ef5350; color:white; border:none; padding:8px 14px; border-radius:8px; cursor:pointer; }

    table { width:100%; border-collapse:collapse; background:white; border-radius:10px; overflow:hidden; }
    th,td { padding:12px; border-bottom:1px solid #eee; text-align:left; }
    th { background:#e3f2fd; }

    .btn { padding:6px 10px; border:none; border-radius:6px; cursor:pointer; margin-right:5px; }
    .edit{background:#64b5f6;color:white;} .delete{background:#ef5350;color:white;} .add{background:#66bb6a;color:white;margin-bottom:10px;}

    .form-box{ background:white; padding:15px; border-radius:10px; margin-bottom:15px; display:none; }
    .form-box input{ padding:8px; margin:5px; }
  </style>
</head>
<body>

  <div id="loginPage">
    <form class="login-box" onsubmit="login(event)">
      <h2>Login Admin ðŸ‘—</h2>
      <input id="loginUser" type="text" placeholder="Username" required />
      <input id="loginPass" type="password" placeholder="Password" required />
      <div id="loginError" class="error"></div>
      <button type="submit">Login</button>
    </form>
  </div>

  <div id="mainApp">
    <div class="topbar">
      <h2>Dashboard Kostum</h2>
      <button class="btn-logout" onclick="logout()">Logout</button>
    </div>

    <button class="btn add" onclick="showForm()">+ Tambah Kostum</button>

    <form class="form-box" id="formBox" onsubmit="saveKostum(event)">
      <input id="nama" placeholder="Nama kostum" required />
      <!-- KODE OTOMATIS -->
      <input id="kode" placeholder="Kode otomatis" readonly />
      <!-- UKURAN TIDAK WAJIB -->
      <input id="ukuran" placeholder="Ukuran" />
      <input id="jumlah" type="number" placeholder="Jumlah" />
      <button type="submit" class="btn add">Simpan</button>
    </form>

    <table>
      <thead>
        <tr>
          <th>Nama</th>
          <th>Kode</th>
          <th>Ukuran</th>
          <th>Jumlah</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>

  <script>
  const USERNAME="admin";
  const PASSWORD="123456";

  const loginPage=document.getElementById("loginPage");
  const mainApp=document.getElementById("mainApp");
  const loginUser=document.getElementById("loginUser");
  const loginPass=document.getElementById("loginPass");
  const loginError=document.getElementById("loginError");
  const formBox=document.getElementById("formBox");
  const nama=document.getElementById("nama");
  const kode=document.getElementById("kode");
  const ukuran=document.getElementById("ukuran");
  const jumlah=document.getElementById("jumlah");
  const tableBody=document.getElementById("tableBody");

  let kostum=JSON.parse(localStorage.getItem("dataKostum"))||[];
  let editIndex=-1;

  function simpanKeStorage(){
    localStorage.setItem("dataKostum",JSON.stringify(kostum));
  }

  function generateKode(){
    const nomor=kostum.length+1;
    return "KST"+String(nomor).padStart(3,"0");
  }

  function login(e){
    e.preventDefault();
    if(loginUser.value===USERNAME && loginPass.value===PASSWORD){
      localStorage.setItem("login","yes");
      loginPage.style.display="none";
      mainApp.style.display="block";
      render();
    }else{
      loginError.innerText="Username atau password salah";
    }
  }

  function logout(){
    localStorage.removeItem("login");
    location.reload();
  }

  window.addEventListener("DOMContentLoaded",()=>{
    if(localStorage.getItem("login")==="yes"){
      loginPage.style.display="none";
      mainApp.style.display="block";
    }
    render();
  });

  function showForm(){
    formBox.style.display="block";
    editIndex=-1;
    formBox.reset();
    kode.value=generateKode();
  }

  function saveKostum(e){
    e.preventDefault();

    const data={
      nama:nama.value.trim(),
      kode:kode.value.trim(),
      ukuran:ukuran.value.trim()||"-",
      jumlah:jumlah.value.trim()||"0"
    };

    if(!data.nama){ alert("Nama wajib diisi"); return; }

    if(editIndex===-1) kostum.push(data);
    else kostum[editIndex]=data;

    simpanKeStorage();
    formBox.style.display="none";
    render();
  }

  function render(){
    tableBody.innerHTML="";

    if(kostum.length===0){
      tableBody.innerHTML='<tr><td colspan="5" style="text-align:center">Belum ada data kostum</td></tr>';
      return;
    }

    kostum.forEach((k,i)=>{
      const row=document.createElement("tr");

      row.innerHTML=`
        <td>${k.nama}</td>
        <td>${k.kode}</td>
        <td>${k.ukuran}</td>
        <td>${k.jumlah}</td>
        <td>
          <button type="button" class="btn edit" data-i="${i}">Edit</button>
          <button type="button" class="btn delete" data-i="${i}">Hapus</button>
        </td>`;

      tableBody.appendChild(row);
    });
  }

  // EVENT LISTENER GLOBAL UNTUK TOMBOL EDIT & HAPUS
  tableBody.addEventListener("click",(e)=>{
    const index=e.target.getAttribute("data-i");
    if(index===null) return;

    if(e.target.classList.contains("edit")){
      editKostum(Number(index));
    }

    if(e.target.classList.contains("delete")){
      hapusKostum(Number(index));
    }
  });

  function editKostum(i){
    const k=kostum[i];
    nama.value=k.nama;
    kode.value=k.kode;
    ukuran.value=k.ukuran==="-"?"":k.ukuran;
    jumlah.value=k.jumlah;
    formBox.style.display="block";
    editIndex=i;
  }

  function hapusKostum(i){
    const yakin=confirm("Hapus kostum ini?");
    if(!yakin) return;

    kostum.splice(i,1);
    simpanKeStorage();
    render();
  }
</script>

</body>
</html>
